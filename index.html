<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wixdex</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    
    <main>

        <section id="deck-area">

            <div id="lrig-deck">
                <h2>ルリグデッキ</h2>
                <div class="card-row" id="lrig-deck-cards">
                </div>
            </div>

            <div id="main-deck">
                <h2>メインデッキ</h2>
                <div class="card-grid" id="main-deck-cards">
                </div>
            </div>

        </section>

        <section id="card-list">

            <h2>カード一覧</h2>

            <div id="cards-container">
            </div>

        </section>

        <section id="search-tool">

            <div id="search-box">検索ツール</div>

        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            fetch('cards.json')
                .then(response => response.json())
                .then(data => {
                    displayCards(data);
                })
                .catch(error => console.error('Error loading card data:', error));
        });

        function displayCards(cards) {
            const cardsContainer = document.getElementById('cards-container');

            cards.forEach(card => {
                const cardElement = document.createElement('div');
                cardElement.classList.add('card');
                
                const cardImage = document.createElement('img');
                cardImage.src = card.image;
                cardImage.alt = card.name;

                cardElement.appendChild(cardImage);
                cardsContainer.appendChild(cardElement);

                // ここでカードにフリックのリスナーを追加
                cardElement.addEventListener('touchstart', handleTouchStart);
                cardElement.addEventListener('touchend', handleTouchEnd);

                let touchStartY = 0;

                function handleTouchStart(event) {
                    touchStartY = event.touches[0].clientY;
                }

                function handleTouchEnd(event) {
                    const touchEndY = event.changedTouches[0].clientY;
                    const swipeDistance = touchStartY - touchEndY;

                    if (swipeDistance > 50) { // 上方向にスワイプ
                        addCardToDeck(card);
                    }
                }
            });
        }

        function addCardToDeck(card) {
            const lrigDeck = document.getElementById('lrig-deck-cards');
            const mainDeck = document.getElementById('main-deck-cards');

            console.log(card); // デバッグ用ログ

            const cardElement = document.createElement('div');
            cardElement.classList.add('card');
            
            const cardImage = document.createElement('img');
            cardImage.src = card.image;
            cardImage.alt = card.name;

            const cardName = document.createElement('p');
            cardName.textContent = card.name;

            cardElement.appendChild(cardImage);
            cardElement.appendChild(cardName);

            const cardType = card.type[0]; // typeの最初の要素を取得

            if (['ルリグ', 'アシストルリグ', 'ピース', 'アーツ'].includes(cardType)) {
                lrigDeck.appendChild(cardElement);
                console.log(`Added ${card.name} to Lrig Deck`);
            } else if (['シグニ', 'スペル'].includes(cardType)) {
                mainDeck.appendChild(cardElement);
                console.log(`Added ${card.name} to Main Deck`);
            } else {
                console.log(`Card type ${cardType} is not recognized`);
            }
        }
    </script>
</body>

</html>
